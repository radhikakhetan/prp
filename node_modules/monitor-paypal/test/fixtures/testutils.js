'use strict';

var wreck = require('wreck');

// Send a request to our private server
module.exports.inject = function inject(urlPath, callback, params) {
    var reqParams = {
        agent: false,
        headers: {'Cookie': 'eager beaver'}
    };
    var url = 'http://localhost:8011' + urlPath;

    params = params || {};

    for (var i in params) {
        if (params.hasOwnProperty(i)) {
            reqParams[i] = params[i];
        }
    }

    wreck.request('GET', url, reqParams, function (error, res) {
        if (error) {
            return callback(error);
        }
        wreck.read(res, null, function (err, body) {
            if (err) {
                return callback(err);
            }
            return callback(null, body && body.toString('utf8'), res.statusCode);
        });

    });
};
